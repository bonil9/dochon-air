<!DOCTYPE html>
<html lang="ko">
<head>
<!--제작자: 구본일
  제작일: 2025년 04월
  용도: 학교 현관 대형 TV 대기 상태 정보 안내
-->
  <meta charset="UTF-8">
  <title>도촌초등학교 대기정보 써비스</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="구본일 (Bon-il Gu)">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom, #e0f7fa, #ffffff); /* 바깥 배경색을 하늘색을 띠는 그라디언트색으로 */
      color: black;
      font-family: 'Noto Sans KR', 'Arial', sans-serif;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
    }

    @font-face {
      font-family: 'SacheonHangGong-Regular';
      src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2506-1@1.0/SacheonHangGong-Regular.woff2') format('woff2');
      font-weight: normal;
      font-style: normal;
    }
    
    h1 {
      background: linear-gradient(to right, red, orange, green, blue, indigo, violet);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 3.5rem;
      font-weight: normal;
      text-align: center;
      margin-bottom: 2rem;
      font-family: 'SacheonHangGong-Regular', 'Noto Sans KR', sans-serif;
    }
    .content-box {
      background-color: white; /* 박스 배경색 흰색 */
      padding: 40px 40px 20px 40px;
      border-radius: 25px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      border: 1px solid #ddd;
    }
    .data-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 50px;
      flex-wrap: wrap;
    }
    .data-box {
      font-size: 1.5rem;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .icon {
      width: 150px;
      height: auto;
      margin-bottom: 10px;
    }
    .value {
      font-size: 2rem;
      font-weight: bold;
    }
    .value .unit {
      font-size: 0.5em; /* 부모(2rem)의 절반 크기인 1rem */
    }
    .status-box {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 6px 16px;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: bold;
      color: white;
      margin-bottom: 8px;
    }
    .good { background-color: #2196F3; }         /* 파랑 */
    .moderate { background-color: #4CAF50; }     /* 초록 */
    .unhealthy { background-color: #FFEB3B; color: black; } /* 노랑 */
    .very-unhealthy { background-color: #F44336; } /* 빨강 */
    .time {
      font-size: 1rem;
      color: #666;
      margin-top: 2rem;
    }
    .source {
      font-size: 0.9rem;
      color: #888;
    }
    .default {
      background-color: #cccccc; /* 회색 배경 */
      color: #333333;
   }
  </style>
</head>
<body>
  <h1>밖에서 놀아도 되는지 볼까요?</h1>
  <div class="content-box">
    <div class="data-container">
      <div class="data-box">
        <img id="pm10-icon" class="icon" src="" alt="미세먼지 아이콘">
        <div id="pm10-status" class="status-box">-</div>
        <p>미세먼지(PM10)<br>
        <span id="pm10" class="value">- <span class="unit">㎍/㎥</span></span></p>
      </div>
      <div class="data-box">
        <img id="pm25-icon" class="icon" src="" alt="초미세먼지 아이콘">
        <div id="pm25-status" class="status-box">-</div>
        <p>초미세먼지(PM2.5)<br>
        <span id="pm25" class="value">- <span class="unit">㎍/㎥</span></span></p>
      </div>
      <div class="data-box">
        <img id="khai-icon" class="icon" src="" alt="통합대기지수 아이콘">
        <div id="khai-status" class="status-box">-</div>
        <p>통합대기지수(CAI)<br>
        <span id="khai" class="value">-</span></p>
      </div>
    </div>
  </div>
  <div class="time">측정시각: <span id="time">불러오는 중...</span></div>
  <div class="source">정보제공: 에어코리아</div>
  <script>
  const API_KEY = "I2l1MdyBG9Dp8RMWz8zuevxESwRBIVQEYbPen%2FhYeCPdLMF7Orh6RndEHg9bD3fWpf1Qc6lIpPKtLROxfHv0%2Bw%3D%3D";
  const station = "양구읍";

  function getStatus(value, type) {
    value = parseInt(value);
    if (isNaN(value)) {
  return {
    label: "수신 정보 없음",
    class: "default",
    icon: "icons/default.png"
  };
}


    if (type === "pm10") {
      if (value <= 30) return { label: "좋음", class: "good", icon: "icons/good.png" };
      else if (value <= 80) return { label: "보통", class: "moderate", icon: "icons/moderate.png" };
      else if (value <= 150) return { label: "나쁨", class: "unhealthy", icon: "icons/unhealthy.png" };
      else return { label: "매우 나쁨", class: "very-unhealthy", icon: "icons/very_unhealthy.png" };
    }
    if (type === "pm25") {
      if (value <= 15) return { label: "좋음", class: "good", icon: "icons/good.png" };
      else if (value <= 35) return { label: "보통", class: "moderate", icon: "icons/moderate.png" };
      else if (value <= 75) return { label: "나쁨", class: "unhealthy", icon: "icons/unhealthy.png" };
      else return { label: "매우 나쁨", class: "very-unhealthy", icon: "icons/very_unhealthy.png" };
    }
    if (type === "khai") {
      if (value <= 50) return { label: "좋음", class: "good", icon: "icons/good.png" };
      else if (value <= 100) return { label: "보통", class: "moderate", icon: "icons/moderate.png" };
      else if (value <= 250) return { label: "나쁨", class: "unhealthy", icon: "icons/unhealthy.png" };
      else return { label: "매우 나쁨", class: "very-unhealthy", icon: "icons/very_unhealthy.png" };
    }
    return { label: "-", class: "default", icon: "icons/default.png" };
  }

  function fetchData() {
    const url = `https://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty?serviceKey=${API_KEY}&numOfRows=1&pageNo=1&dataTerm=DAILY&ver=1.3&stationName=${station}&returnType=json`;

    fetch(url)
      .then(response => response.json())
      .then(data => {
        const item = data.response.body.items[0];
        document.getElementById("time").textContent = item.dataTime;

        const pm10Status = getStatus(item.pm10Value, "pm10");
        document.getElementById("pm10").innerHTML = item.pm10Value + ' <span class="unit">㎍/㎥</span>';
        document.getElementById("pm10-status").textContent = pm10Status.label;
        document.getElementById("pm10-status").className = "status-box " + pm10Status.class;
        document.getElementById("pm10-icon").src = pm10Status.icon;

        const pm25Status = getStatus(item.pm25Value, "pm25");
        document.getElementById("pm25").innerHTML = item.pm25Value + ' <span class="unit">㎍/㎥</span>';
        document.getElementById("pm25-status").textContent = pm25Status.label;
        document.getElementById("pm25-status").className = "status-box " + pm25Status.class;
        document.getElementById("pm25-icon").src = pm25Status.icon;

        const khaiValue = (item.khaiValue && item.khaiValue !== "-") ? item.khaiValue : item.khaiGrade || "-"; 
        const khaiStatus = getStatus(khaiValue, "khai");
        document.getElementById("khai").textContent = khaiValue;
        document.getElementById("khai-status").textContent = khaiStatus.label;
        document.getElementById("khai-status").className = "status-box " + khaiStatus.class;
        document.getElementById("khai-icon").src = khaiStatus.icon;
      })
      .catch(error => {
        console.error("에러:", error);
        document.getElementById("time").textContent = "정보 불러오기 실패";
      });
  }

  fetchData();
  setInterval(fetchData, 5 * 60 * 1000);
</script>

</body>
</html>
